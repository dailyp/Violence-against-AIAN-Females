---
title: "R Notebook"
output: html_notebook
---

library(ggplot2)
library(choroplethr)
library(readr)
library(dplyr)
library(tidyverse)
#data(state_choropleth)


#First start by reading in AIAN female violent death dataset 
```{r}
viol_death_map <- read_csv("data/death_map2.csv")
```
Remove the "X1" column
```{r}
viol_death_map <- viol_death_map %>% 
  select(-"X1")
```
Convert "Deaths" column to integer
```{r}
viol_death_map <- viol_death_map %>% 
  mutate_at(c(2), as.numeric)
```
Convert NAs in Deaths column to 0
```{r}
viol_death_map$Deaths[is.na(viol_death_map$Deaths)] <- 0
```
Per Choroplethr package, create columns region for State, and Value for # Deaths
```{r}
viol_death_map$region <- tolower(viol_death_map$State)
viol_death_map$value <- viol_death_map$Deaths
```
```{r}
write.csv(viol_death_map, "data/viol_death_map.csv", row.names = TRUE)
```
```{r}
view(viol_death_map)
```

#########################
read in missing/unidentified/unclaimed female AIANs to create comparative map with deaths dataset
```{r}
muu_map <- read_csv("data/muu_state2.csv")
```
remove the X1 column
```{r}
muu_map <- muu_map %>% 
  select(-"X1")
```
convert "n" (number) column to numeric
```{r}
muu_map <- muu_map %>% 
  mutate_at(c(2), as.numeric)
```
convert state to region, and number to value as per Choroplethr
```{r}
muu_map$region <- tolower(muu_map$State)
muu_map$value <- muu_map$n
```
```{r}
view(muu_map)
```
```{r}
write.csv(muu_map, "data/muu_map.csv", row.names = TRUE)
```

Create Violent Death map
```{r}
state_choropleth(viol_death_map, 
                 num_colors=9) +
  scale_fill_brewer(palette="YlOrBr") +
  labs(title = "AIAN Violent Deaths by State",
       #subtitle = "",
       caption = "source: CDC",
       fill = "Events") 
```
create missing/unident/unclaim map 
```{r}

state_choropleth(muu_map, 
                 num_colors=9, zoom = NULL) +
  scale_fill_brewer(palette="YlOrRd") +
  labs(title = "AIAN Murdered/Unidentified/Unclaimed by State",
       subtitle = "as of January 4, 2021",
       caption = "source: NamUs",
       fill = "Events") 
```




